@import "interfaces/variables"
@import "interfaces/core/queries"

// localized variables  ====================================
$max-modal-width:   $max-site-width * .95
$modal-default-top: 46px


// @mixins - fixed scrollable component ====================
=fixed-scrollable-component($component)
  .#{$component}
    @content

=fixed-scrollable-component-parent($component)
  .#{$component}--open
    overflow: hidden

  .#{$component}--open .#{$component}-layer
    display: block

  .#{$component}--open .#{$component}-layer .#{$component}
    display: block

=fixed-scrollable-component-stage($component)
  .#{$component}-layer
    position: fixed
    top: 0
    right: 0
    bottom: 0
    left: 0

    z-index: 1000

    overflow: auto
    overflow-y: scroll

    -webkit-overflow-scrolling: touch

    transform: translate3d(0,0,0)

    @content


// modal component - structure =============================
+fixed-scrollable-component('modal')
  position: relative

  display: none

  margin: $modal-default-top auto 0

  background-color: $modal-window-bg-color

  z-index: 1100

  border-radius: ($modal-radius + 1) ($modal-radius + 1) $modal-radius $modal-radius
  box-shadow: 0 0 25px $dark-gray

  +breakpoint(lte_palm)
    margin: 3% auto !important
    width: 94% !important
    min-width: inherit !important
    max-width: inherit !important

+fixed-scrollable-component-parent('modal')

+fixed-scrollable-component-stage('modal')
  display: none

  background-color: $modal-bg-color


// modal component - sizing ================================
.modal,
.modal--medium
  max-width: 600px

.modal--small
  max-width: 500px

.modal--large
  max-width: 900px

.modal--full
  width: 95%
  max-width: $max-modal-width

+breakpoint(bp_1)
  .modal-layer
    padding: 0 15px

// modal other =============================================

.modal [data-modal-close]
  cursor: pointer

// vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
// vvvvvv ANYTHING UNSTABLE SHOULD GO BELOW THIS LINE vvvvvv
// vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv


// modal component - immediate child elements ==============
.modal__header
  padding: 16px 18px 20px 18px
  background: $modal-header-color

  border-radius: $modal-radius $modal-radius 0 0

.modal__body
  padding: 12px

  +breakpoint(lte_tablet)
    height: 100%

.modal__footer
  padding: 10px 10px 11px 10px

  text-align: right

  border-bottom-right-radius: $modal-child-radius
  border-bottom-left-radius: $modal-child-radius

  border-top: solid 1px adjust-color($modal-window-bg-color, $lightness: -10%, $saturation: -5%)

  .btn
    margin-bottom: 0

  .btn.left
    position: relative

    top: 2px
    left: 2px

    margin: 0

.modal-section
  position: relative
  padding: 15px 0
  +cf

.modal-loader.preloader
  position: absolute
  left: 50%
  width: 230px
  margin-left: -115px
  top: ($modal-default-top + 22px)


// MODAL BAND =================================
.modal__band
  margin: 0 -12px
  padding: 15px 12px
  &:first-child
    margin-top: -15px
  &:first-child:last-child
    margin-bottom: -1px
  &.push, .push
    margin-bottom: 15px
  .row__child
    margin: 20px auto
  &:last-child:not(.modal__band--subtle),
  &:last-child:not(.modal__band--topper.modal__band)
    padding-bottom: 0
  .col:first-of-type
    padding-left: 0
  .col:last-of-type
    padding-right: 0
    margin-bottom: 0

.modal__band--topper
  background: adjust-color($base-color, $lightness: 49%, $saturation: -10%)
  .badge
    margin-right: 8px
    background: adjust-color($base-color, $lightness: 43%, $saturation: -10%)
    border: 0
  +breakpoint(bp_1)
    .row.mb0 .col
      margin-bottom: 0

// PERSON MODAL =================================
.modal__band--person
  height: 130px
  position: relative
  +breakpoint(lte_palm)
    height: 180px
    .col
      margin-bottom: 0
  &.modal__band .row
    margin: 0 8px 0 120px
  label
    margin-top: 10px
  .palm--full
    clear: none

  .avatar
    position: relative
    z-index: 1
    border-radius: 100em
    float: left
    width: 91px
    top: 5px
    left: 7px

  .bg-img-fill
    position: absolute
    top: 0px
    left: 0
    right: 0
    bottom: 0
    overflow: hidden
    img
      position: absolute
      top: 0
      left: 0
      right: 0
      bottom: 0
      display: block
      min-width: 120%
      margin-top: -50%
      margin-left: -12%
      opacity: .4

      filter: blur(30px)

//This is specific to the person modal. not sure it can be generified any more??
.modal--person-details
  .hover-icon-trigger .col
    margin-bottom: 0
  +breakpoint(lte_palm)
    .block-list.eq-pad .hover-icon-trigger
      padding: 8px 9px 8px 6px
      .palm--third:first-child
        padding-right: 7px
  +breakpoint(bp_2)
    .modal__band--subtle .palm--full
      margin-bottom: 0

/*CONTENT IN THE TABS SECTIONS*/
h4.smaller
  font-size: 14px
input.mb8
  margin-bottom: 8px

.col-tighter-pad
  +breakpoint(bp_1)
    padding-right: 10px

.field-container.block-list__item
  border-radius: 3px
  .col
    margin-bottom: 0

.subtle-bg
  background: adjust-color($sidebar-bg-color, $lightness: 1%, $saturation: -10%)

/*CONTACT*/
.modal--person-details h4.smaller a
  font-size: 13px
  padding: 2px 6px 4px 6px
  [class^="icon-"], [class*=" icon-"]
    font-size: 16px
    color: adjust-color($success-color, $lightness: 10%, $saturation: -6%)
    margin-right: 6px

.modal--person-details .has-icon-right > .icon
  top: 13px
  right: -3px
  .ii-x
    color: darken($lighter-gray, 8%)
  &:hover .ii-x
    color: $danger-color

/*PERSONAL INFO*/
.modal--person-details
  .pane-group
    margin-bottom: 0
    .pane
      margin-bottom: -1px
  h4 .badge
    margin-left: 5px
#personal
  .modal-well .alert
    margin: 13px auto 0

/*ATTENDANCE*/
#attendance
  margin-bottom: -12px
  padding-bottom: 0

.justified-table-wrap
  margin: 0 -13px 0 -14px

.modal--person-details .events.table
  margin: 0
  td, th
    &:first-child
      padding-left: 20px
    &:last-child
      padding-right: 20px
  th
    border-bottom-width: 1px
    border-bottom-color: adjust-color($base-color, $lightness: 4%, $saturation: -2%)
  td
    font-size: 12px
  .event-col
    width: 160px
  .text-center
    text-align: center

//@end PERSON MODAL


// modal component - immediate child elements ==============

//remove padding from top of first section
.modal-well .modal-section:first-child
  padding-top: 0

//remove padding from bottom of last section
.modal-well .modal-section:last-child
  padding-bottom: 0

.modal-well .modal-section.modal-section--subtle
  padding: 15px
  &.control-group
    padding: 7.5px

.modal__header, .modal__footer, .modal__body
  +cf

.modal-well .modal-section:last-child
  padding-bottom: 0

.modal-section
  padding: 15px 0

.modal-title
  margin: 0

  font-size: 19px
  color: $modal-title-color
  +truncate()
  text-shadow: 0 1px 4px rgba(adjust-color($modal-header-color, $lightness: -20%, $saturation: -5%), .5)

.modal-well__heading
  font-size: 1.3em
  padding-bottom: 8px
  // border-bottom: 1px solid #E9E9E9

.modal-well__sub-heading
  font-size: 1.1em
  margin-bottom: 5px

//WELLS AND OTHER LAYOUT COMPONENTS FOR MODALS
.modal-well
  position: relative
  border-radius: 2px
  background: #fff
  padding: 12px
  border: 1px solid adjust-color($sidebar-bg-color, $lightness: -3%, $saturation: -10%)
  +cf

  p
    padding: 0
    &:last-child
      margin: 0
  .col:first-of-type
    padding-left: 0
  .col:last-of-type
    padding-right: 0
  &.push-top
    margin-top: 15px
  &.modal-well--padless
    padding: 0
    border: 0
  &.modal-well--naked
    border-color: transparent
    background: transparent

.modal-section--subtle
  background: adjust-color($sidebar-bg-color, $lightness: 1%, $saturation: -10%)
  padding: 10px
  border-radius: 3px


.modal-well, .modal__band
  .row
    margin-left: auto
    margin-right: auto

.modal__band.full-width-tabs
  padding: 0
