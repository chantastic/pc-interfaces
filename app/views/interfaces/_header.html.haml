- icon_name = Rails.application.class.parent_name.underscore.dasherize

.top-bar.js-dropwrap
  .top-bar__contents.clearfix
    .title-area
      / Title Area
      .app-switcher-wrap.js-togglehelper
        =# link_to '<span class="icon-accounts-logo" aria-hidden="true"></span>'.html_safe, '/', id: 'logo', class: 'bookmark', :title => "Link to Planning Center Accounts Home", :tabindex => "1"
        #logo.bookmark{ class: "icon-#{icon_name}-logo", "aria-hidden" => "true"}
        / - if current_organization.subscribed_apps.any?
        .app-switcher
          .toggle-btn
            .chevron
          .menu-wrap
            .toggle-btn-cover
              %span.interfaces-remove.interfaces-close
            %ul
              - if defined? @current_person
                - available_apps = @current_person.organization.subscribed_apps
                - available_apps.each_with_index do |app, index|
                  %li{ class: [app.name.downcase, (:omega if index + 1 == available_apps)] }
                    %a{ href: app.url }
                      %span.icon{ "aria-hidden" => "true" }
                      %em planning center
                      = app.name

              - else
                %li.services
                  %a{ href: "#" }
                    %span.icon{ "aria-hidden" => "true" }
                    %em planning center
                    Services (fake)
                %li.resources
                  %a{ href: "#" }
                    %span.icon{ "aria-hidden" => "true" }
                    %em planning center
                    Resources (fake)
                %li.check-ins
                  %a{ href: "#" }
                    %span.icon{ "aria-hidden" => "true" }
                    %em planning center
                    Check-ins (fake)

      #toggle-sidebar.menu-icon.show-for-mobile
        %a{href: "#"}
          %span.title Sidebar
          %span.interfaces-cog{"aria-hidden" => "true"}

      #toggle-topbar.js-droptoggle.menu-icon.show-for-mobile
        %a{href: "#"}
          %span.title Menu
          %span.interfaces-menu{"aria-hidden" => "true"}

    %section.top-bar-section
      / Main Navi Area
      .top-nav-options
        %nav.global-nav.lefty{"role" => "menubar", :title => "Main Site Navigation"}
          %ul
            %li.divider
            = yield

        %div.account-info.righty.js-dropwrap
          %span.avatar
            - if defined? @current_person
              %a.photo{href: "/people/1"}
                %img{alt: "Missing", height: "24", src: "https://www.planningcenteronline.com/photos/icon/missing.png", width: "24"}

            - else
              %a.photo{href: "/people/1"}
                %img{alt: "Missing", height: "24", src: "https://www.planningcenteronline.com/photos/icon/missing.png", width: "24"}

          #toggle-account-details.js-droptoggle
            %span.interfaces-caret{ "aria-hidden" => "true"}
          #account-details
            %ul.identity
              %li.section-heading
                - if defined? @current_person
                  %a{href: "#"}= @current_person.name
                  %span |
                  = @current_person.organization.name

                - else
                  %a{href: "/people/1"} PiCO Das Robot (Fake)
                  %span |
                  First Church Of Carlsbad (Fake)
            %ul.utilities
              %li
                %a.dialogify{href: "/help", width: "600"}
                  %span.interfaces-faq
                  help (needs implementation)
              %li
                %a.log{href: "/logout"}
                  logout
